<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper.MissingMapper">
	<resultMap type="dto.MissingPersonDTO" id="missing">
		<id column="missing_serialNum" property="missingSerialNum"></id>
		<result column="member_serialNum" property="memberSerialNum" />
		<result column="admin_serialNum" property="adminSerialNum" />
		<result column="missing_name" property="name" />
		<result column="missing_gender" property="gender" />
		<result column="missing_birth" property="birth" />
		<result column="missing_etc" property="etc" />
		<result column="missing_place" property="place" />
		<result column="missing_date" property="missingDate" />
		<result column="missing_img" property="image" />
	</resultMap>

  <select id = "selectMissingList" resultMap="missing">
    select * from missing_info
  </select>

  <insert id="insertMissingPerson" parameterType="dto.MissingPersonDTO">
    INSERT INTO missing_info (
        member_serialNum, admin_serialNum, missing_name,
        missing_gender, missing_birth, missing_etc,
        missing_place, missing_date, missing_img
    ) VALUES (
        #{memberSerialNum}, #{adminSerialNum}, #{name},
        #{gender}, #{birth}, #{etc},
        #{place}, TO_DATE(#{missingDate}, 'YYYY-MM-DD'), #{image}
    )
  </insert>

  <!-- 실종자 정보 삭제 쿼리 -->
  <delete id="deleteMissingPerson" parameterType="string">
    DELETE FROM missing_info WHERE missing_serialNum = #{missingSerialNum}
  </delete>

  <!-- 권한 검사를 위한 특정 실종자 정보 조회 쿼리 -->
  <select id="selectMissingPersonBySerial" parameterType="string" resultMap="missing">
    SELECT * FROM missing_info WHERE missing_serialNum = #{missingSerialNum}
  </select>

</mapper>
